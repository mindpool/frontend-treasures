# #1 \<srcipt\> \<srcipt async\> \<srcipt defer\> 的区别

在HTML中, `async` 和 `defer` 是 `script` 标签的两个常用属性，用于控制脚本的加载和执行时机。

它们的区别在于浏览器加载和执行脚本的顺序。

## 默认情况（无`async`和`defer`）

在默认情况下，浏览器会`按顺序`加载和执行脚本，`阻塞`页面渲染。浏览器遇到 `<script>` 标签时会立即加载和执行该脚本，加载完毕后再继续解析 HTML。

## `async`

- **加载时机：** 浏览器在`解析HTML的同时异步加载`带有带有`async`的脚本，不会阻塞HTML解析。
- **执行时间：** 脚本加载完毕后会立即执行（不等待HTML解析完成）。
- **执行顺序：** 如果页面中有多个 async 脚本，它们的执行顺序可能会不一致，取决于哪个脚本先加载完毕。
- **适用场景：** 适合加载一些不依赖其他脚本或 DOM 的独立脚本，比如统计代码或广告脚本。

## `defer`

- **加载时机：** 与 async 类似，defer 脚本也是在 HTML 解析的同时异步加载，不会阻塞 HTML 解析。
- **执行时机：** 等到 HTML 解析完成后再按顺序执行。
- **执行顺序：** defer 脚本的执行顺序与它们在页面中的顺序一致。
- **适用场景：** 适合需要依赖 DOM 或其他脚本的脚本，通常用于初始化操作。

defer脚本总是在 DOM 准备好时执行（但在DOMContentLoaded事件之前）

比如我们有两个脚本一个`long`, 一个`small.js`，`long.js`脚本比较大，`small.js`脚本比较小。

```html
<script src="long.js" defer></script>
<script src="small.js" defer></script>
```

这两个脚本会并行下载，`small.js` 可能会在 `long.js` 之前下载完成，但是执行顺序是按照它们在页面中的顺序执行的，会先执行 `long.js`，再执行 `small.js`。


## 总结

执行图如下：

![](/html/html-q1.png)


| 属性 | 加载时机 |	执行时机 | 执行顺序 |
| :----: | :----:  | :----:  | :----:  |
|默认 | 阻塞解析，立即加载 | 加载完立即执行 | 按顺序 |
|async | 异步加载，不阻塞解析 |	加载完立即执行 | 无顺序（谁先加载完先执行）|
|defer | 异步加载，不阻塞解析 |	HTML 解析完成后执行 | 按页面中顺序 |

选择 async 或 defer 取决于脚本是否需要等待 HTML 完成解析，以及是否需要按顺序执行。

:::warning 注意:

async和defer属性都仅适用于外部脚本，如果script标签没有src属性，尽管写了async、defer属性也会被忽略

:::
